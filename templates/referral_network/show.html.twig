{% extends 'base.html.twig' %}

{% block title %}ReferralNetwork{% endblock %}

{% block body %}
<div class="container-xxl">
    <h1>Информация об участнике сети</h1>
    {% for label, messages in app.flashes(['success', 'notice']) %}
            {% for message in messages %}
                <div class="alert alert-success" role="alert">
                    {{ message }}
                </div>
            {% endfor %}
    {% endfor %}
    {% for label, messages in app.flashes(['info', 'notice']) %}
                {% for message in messages %}
                    <div class="alert alert-info" role="alert">
                        {{ message }}
                    </div>
                {% endfor %}
    {% endfor %}
    {% for label, messages in app.flashes(['danger', 'notice']) %}
                {% for message in messages %}
                    <div class="alert alert-danger" role="alert">
                        {{ message }}
                    </div>
                {% endfor %}
    {% endfor %}
    {% for label, messages in app.flashes(['warning', 'notice']) %}
                {% for message in messages %}
                    <div class="alert alert-danger" role="alert">
                        {{ message }}
                    </div>
                {% endfor %}            
    {% endfor %}
    <div class="col-xs-12 text-center shadow p-3 mb-1 bg-light rounded">
      <h2>Структура ваших начислений дохода в сети</h2>
    </div>
    <div class="row justify-content-center">
        <div class="col-sm-12 mb-1">
            <div class="card text-center shadow p-3 mb-1 bg-light rounded">
                <div class="card-body">
                    <div id="donut-chart"></div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-sm-12 mb-1">
            <div class="card shadow p-3 mb-1  rounded" style="background: #5eabeb;">
                <div class="card-body d-flex justify-content-between">    
                    <span><h5 class="card-title">Отстаток начсиленных доходов в сети для перевода на кошелек</h5></span>
                    <span><h5 class="card-title">{{ referral_network.rewardWallet }} USDT</h5></span>    
                </div>
            </div>
    </div>
    <div class="col-sm-12 mb-1">
            <div class="card  shadow p-3 mb-1 bg-light rounded">
                <div class="card-body d-flex justify-content-between">    
                    <span><h5 class="card-title">Всего переведено доходов на кошелек с момента активации пакета</h5></span>
                    <span><h5 class="card-title">{{ referral_network.withdrawalToWallet }} USDT</h5></span>    
                </div>
            </div>
    </div>
    <div class="row justify-content-center">
        <div class="col-sm-4 mb-1">
            <div class="card text-center shadow p-3 mb-1 bg-light rounded">
                <div class="card-body">    
                    <img src="{{ asset('asset/img/ingle-1.jpeg') }}" class="card-img-top" alt="" style="max-width: 290px;">
                    <h5 class="card-title">Сеть с левой стороны</h5>
                    <p class="card-text">Баланс сети слева {{ data.summ_left }} USDT</p>
                    <p class="text-warning shadow p-3 mb-1  rounded" style="background: #5eabeb;">Количество участников слева : {{ data.count_left }}</p>
                    {# <a href="#" class="btn btn-primary">Перейти куда-нибудь</a> #}
                </div>
            </div>
        </div>
        <div class="col-sm-4 mb-1">
            <div class="card text-center shadow p-3 mb-1 bg-light rounded">
                <div class="card-body">
                <img src="{{ asset('asset/img/fon-default-avatar-1.png') }}" class="card-img-top" alt="" style="max-width: 160px;">
                    <h5 class="card-title">Моё место в сети</h5>
                    <p class="card-text">Мой баланс всех начислений</p>
                    {% if data.my_summ == NULL %}  
                    <p class="text-warning shadow p-3 mb-1  rounded" style="background: #5eabeb;">0.00 USDT</p>
                    {% else %}
                    <p class="text-warning shadow p-3 mb-1  rounded" style="background: #5eabeb;">{{ data.my_summ }} USDT</p>
                    {% endif %}
                    {# <a href="#" class="btn btn-primary">Перейти куда-нибудь</a> #}
                </div>
            </div>
        </div>
        <div class="col-sm-4 mb-1">
            <div class="card text-center shadow p-3 mb-1 bg-light rounded">
                <div class="card-body">
                <img src="{{ asset('asset/img/ingle-1.jpeg') }}" class="card-img-top" alt="" style="max-width: 290px;">
                    <h5 class="card-title">Сеть с правой стороны</h5>
                    <p class="card-text">Баланс сети справа {{ data.summ_right }} USDT</p>
                    <p class="text-warning shadow p-3 mb-1 rounded" style="background: #5eabeb;">Количество участников справа : {{ data['count_right'] }}</p>
                    {# <a href="#" class="btn btn-primary">Перейти куда-нибудь</a> #}
                </div>
            </div>
        </div>
    </div>
    <div class="col-sm-12 mb-1">
            <div class="card  shadow p-3 mb-1 bg-light rounded">
                <div class="card-body d-flex justify-content-between">    
                    <span><h5 class="card-title">Моя личная реферальная ссылка</h5></span>
                    <span><h5 class="card-title">{{ referral_network.memberCode }}</h5></span>    
                </div>
            </div>
    </div>
        <div class="col-sm-12 mb-1">
            <div class="card text-center shadow p-3 mb-1 bg-light rounded">
                <div class="card-body">
                    {% if is_granted('ROLE_ADMIN') %}  
                    <a  class="btn btn-secondary mb-1" href="{{ path('app_referral_network_index') }}">К списку всех участников</a>
                    {% else %}
                    <a  class="btn btn-secondary mb-1" href="{{ path('app_personal_area') }}">В личный кабинет</a>
                    {% endif %}
                    <a  class="btn btn-secondary mb-1" href="{{ path('app_referral_network_myteam',{'my_team': referral_network.myTeam}) }}">Моя команда</a>
                    <a  class="btn btn-secondary mb-1" href="{{ path('app_personal_area') }}">Повысить пакет</a>
                    
                    <a class="btn btn-warning mb-1" href="{{ path('app_referral_network_edit', {'id': referral_network.id}) }}">Редактировать</a>

                    {{ include('referral_network/_delete_form.html.twig') }}
                </div>
            </div>
        </div>
    <div class="col-sm-12 mb-1">
            <div class="card  shadow p-3 mb-1 bg-white rounded">
                <div class="card-body">
                    <table class="table">
                        <tbody>
                            <tr class="shadow p-3 mb-1 bg-light rounded">
                                <th>Имя пользователя</th>
                                <td>{{ referral_network.name }}</td>
                            </tr>
                            <tr class="shadow p-3 mb-1 bg-light rounded">
                                <th>Статус пользователя</th>
                                <td>{{ referral_network.userStatus }}</td>
                            </tr>
                            <tr class="shadow p-3 mb-1 bg-light rounded">
                                <th>Мой начисления по программе cashback</th>
                                <td>{{ referral_network.cash }} USDT</td>
                            </tr>
                            <tr class="shadow p-3 mb-1 bg-light rounded">
                                <th>Мои начисления по программе Direct</th>
                                <td>{{ referral_network.direct }} USDT</td>
                            </tr>
                            <tr class="shadow p-3 mb-1 bg-light rounded">
                                <th>Общее количество начисленных наград</th>
                                <td>{{ referral_network.reward }} USDT</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
    </div>
    <div class="col-sm-12 mb-1">
            <div class="card  shadow p-3 mb-1 bg-white rounded">
                <div class="card-body">
                    <table class="table">
                        <tbody>
                            <tr class="shadow p-3 mb-1 bg-light rounded">
                                <th>Моя команда - колчество участников</th>
                                <td>{{ my_team_count }}</td>
                            </tr>
                            <tr class="shadow p-3 mb-1 bg-light rounded">
                                <th>Моя команда - баланс(общая стоимость пакетов)</th>
                                <td>{{ my_team_summ }} USDT</td>
                            </tr>
                            {% if(referral_network.cash <= (referral_network.pakage * k_cash_back)) %}
                            <tr class="shadow p-3 mb-1 bg-light rounded">   
                                <th>Стоимость моего пакета</th>
                                {# <td>{{ pakege_user.name }} , {{ pakege_user.price  }} USDT</td> #}
                                <td>{{ referral_network.pakage }} USDT</td>
                            </tr> 
                            {% else %}
                            <tr class="text-white shadow p-3 mb-1 bg-danger rounded">
                                <th>Стоимость моего пакета</th>
                                    <td>{{ referral_network.pakage }} USDT Внимание! достигнут лимит пополнения кошелька бонусами cashback</td>
                            </tr>        
                            {% endif %}
                        </tbody>
                    </table>
                </div>
            </div>
    </div>
    {% if is_granted('ROLE_ADMIN') %}
    <div class="col-sm-12 mb-1">
            <div class="card  shadow p-3 mb-1 bg-white rounded">
                <div class="card-body">
                <table class="table">
                    <tbody>    
                        <h5 class="card-title mb-3">Для Администратора - информация о сети на момент активации пакета данного пользователя</h5>
                        <tr class="shadow p-3 mb-1 bg-light rounded">
                            <th>Выплата в компанию (проект) в момент активации пакета данного участника</th>
                            <td>{{ referral_network.currentNetworkProfit }} USDT</td>
                        </tr>
                        <tr class="shadow p-3 mb-1 bg-light rounded">
                            <th>Выплата в сеть по программе Direct в момент активации пакета данного пользователя</th>
                            <td>{{ referral_network.paymentsNetwork }} USDT</td>
                        </tr>
                        <tr class="shadow p-3 mb-1 bg-light rounded">
                            <th>Выплата в сеть по программе Cash back в момент активации пакета данного пользователя</th>
                            <td>{{ referral_network.cash }} USDT</td>
                        </tr>    
                    </tbody>
                </table>
                </div>
            </div>
    </div>
    {% endif %}
</div>
<script>
var chart = bb.generate({
        data: {
          columns: [
            ["Blue USDT", {{ referral_network.direct }}],
            ["Orange Cometpoin", {{ referral_network.cash }}],
            //["green", 3],
          ],
          type: "donut",
          onclick: function (d, i) {
            console.log("onclick", d, i);
          },
          onover: function (d, i) {
            console.log("onover", d, i);
          },
          onout: function (d, i) {
            console.log("onout", d, i);
          },
        },
        donut: {
          title: "{{ referral_network.reward }} USDT",
        },
        bindto: "#donut-chart",
      });
</script>
{% endblock %}
