{% extends 'base.html.twig' %}

{% block title %}ReferralNetwork{% endblock %}

{% block body %}
<div class="container-xxl">
    <h1 class="text-secondary">Информация об участнике сети</h1>
    {% for label, messages in app.flashes(['success', 'notice']) %}
            {% for message in messages %}
                <div class="alert alert-success" role="alert">
                    {{ message }}
                </div>
            {% endfor %}
    {% endfor %}
    {% for label, messages in app.flashes(['info', 'notice']) %}
                {% for message in messages %}
                    <div class="alert alert-info" role="alert">
                        {{ message }}
                    </div>
                {% endfor %}
    {% endfor %}
    {% for label, messages in app.flashes(['danger', 'notice']) %}
                {% for message in messages %}
                    <div class="alert alert-danger" role="alert">
                        {{ message }}
                    </div>
                {% endfor %}
    {% endfor %}
    {% for label, messages in app.flashes(['warning', 'notice']) %}
                {% for message in messages %}
                    <div class="alert alert-danger" role="alert">
                        {{ message }}
                    </div>
                {% endfor %}            
    {% endfor %}
    <div class="col-xs-12 text-secondary text-center shadow p-3 mb-1 bg-light rounded">
      <h5>Структура ваших начислений дохода в сети в USDT</h5>
    </div>
    <div class="row justify-content-center">
        <div class="col-sm-12 mb-1">
            <div class="card text-center shadow p-3 mb-1 bg-light rounded">
                <div class="card-body">
                    <div id="donut-chart-my-position"></div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-sm-12 mb-1">
            <a href=""  class="card text-white shadow p-3 mb-1  rounded btn" style="background: #5eabeb;">
                <div class="card-body d-flex justify-content-between">    
                    <span><h6 class="card-title">Отстаток начсиленных доходов в сети для перевода на кошелек</h6></span>
                    <span><h6 class="card-title">{{ referral_network.rewardWallet }} USDT</h6></span>    
                </div>
            </a>
    </div>
    <div class="col-sm-12 mb-1">
            <div class="card text-secondary shadow p-3 mb-1 bg-light rounded">
                <div class="card-body d-flex justify-content-between">    
                    <span><h6 class="card-title">Всего переведено доходов на кошелек с момента активации пакета</h6></span>
                    <span><h6 class="card-title">{{ referral_network.withdrawalToWallet }} USDT</h6></span>    
                </div>
            </div>
    </div>
    <div class="row justify-content-center">
        <div class="col-sm-4 mb-1">
            <div class="card text-secondary text-center shadow p-3 mb-1 bg-white rounded">
                <div class="card-body">    
                    <img src="{{ asset('asset/img/network-3.png') }}" class="card-img-top" alt="" style="max-width: 101px;">
                    <h5 class="card-title">Сеть с левой стороны</h5>
                    <p class="card-text">Баланс сети слева {{ data.summ_left }} USDT</p>
                    <p class="text-warning shadow p-3 mb-1  rounded-0 fw-bolder" style="background: #5eabeb;">Количество участников слева : {{ data.count_left }}</p>
                    {# <a href="#" class="btn btn-primary">Перейти куда-нибудь</a> #}
                </div>
            </div>
        </div>
        <div class="col-sm-4 mb-1">
            <div class="card text-secondary text-center shadow p-3 mb-1 bg-white rounded">
                <div class="card-body">
                <img src="{{ asset('asset/img/fon-default-avatar-1.png') }}" class="card-img-top" alt="" style="max-width: 100px;">
                    <h5 class="card-title">Моё место в сети</h5>
                    <p class="card-text">Мой баланс всех начислений</p>
                    {% if data.my_summ == NULL %}  
                    <p class="text-warning shadow p-3 mb-1  rounded-0 fw-bolder" style="background: #5eabeb;">0.00 USDT</p>
                    {% else %}
                    <p class="text-warning shadow p-3 mb-1  rounded-0 fw-bolder" style="background: #5eabeb;">{{ data.my_summ }} USDT</p>
                    {% endif %}
                    {# <a href="#" class="btn btn-primary">Перейти куда-нибудь</a> #}
                </div>
            </div>
        </div>
        <div class="col-sm-4 mb-1">
            <div class="card text-secondary text-center shadow p-3 mb-1 bg-white rounded">
                <div class="card-body">
                <img src="{{ asset('asset/img/network-3.png') }}" class="card-img-top" alt="" style="max-width: 101px;">
                    <h5 class="card-title">Сеть с правой стороны</h5>
                    <p class="card-text">Баланс сети справа {{ data.summ_right }} USDT</p>
                    <p class="text-warning shadow p-3 mb-1 rounded-0 fw-bolder" style="background: #5eabeb;">Количество участников справа : {{ data['count_right'] }}</p>
                    {# <a href="#" class="btn btn-primary">Перейти куда-нибудь</a> #}
                </div>
            </div>
        </div>
    </div>
    <div class="col-sm-12 mb-1">
            <a data-fancybox data-src="#hidden-content-referral" href="javascript:;" class="card text-secondary shadow p-3 mb-1 bg-light rounded btn">
                <div class="card-body row justify-content-between">    
                    <span><h6 class="card-title">Моя личная реферальная ссылка (нажмите чтобы отправить)</h6></span>
                    <span><h6 class="card-title text-dark">{{ referral_network.memberCode }}</h6></span>    
                </div>
            </a>
    </div>
    {% if(referral_network.cash <= (referral_network.pakage * k_cash_back)) %}
    <div class="col-sm-12 mb-1">
            <a href="" class="card text-secondary shadow p-3 mb-1 bg-light rounded btn">
                <div class="card-body row justify-content-between">    
                    <span><h6 class="card-title">Мой пакет (нажмите чтобы повысить)</h6></span>
                    <span><h6 class="card-title text-dark">{{ referral_network.pakage }} USDT</h6></span>    
                </div>
            </a>
    </div>
    {% else %}
    <div class="col-sm-12 mb-1">
            <a href="" class="card text-white shadow p-3 mb-1 bg-danger rounded btn">
                <div class="card-body row justify-content-between">    
                    <span><h6 class="card-title">Мой пакет Внимание! вы достигли предела выплат cashback, необходимо повысить пакет (нажмите чтобы повысить)</h6></span>
                    <span><h6 class="card-title text-dark">{{ referral_network.pakage }} USDT</h6></span>    
                </div>
            </a>
    </div>
    {% endif %}
    <div class="col-sm-12 mb-1">
            <a href="" class="card text-secondary shadow p-3 mb-1 bg-light rounded btn">
                <div class="card-body row justify-content-between">    
                    <span><h6 class="card-title">Моя команда - количество участников (нажмите чтобы посмотреть подробности)</h6></span>
                    <span><h6 class="card-title text-dark">{{ my_team_count }}</h6></span>    
                </div>
            </a>
    </div>
    <div class="col-sm-12 mb-1">
            <a href="" class="card text-secondary shadow p-3 mb-1 bg-light rounded btn">
                <div class="card-body d-flex justify-content-between">    
                    <span><h6 class="card-title">Моя команда - баланс (нажмите чтобы посмотреть)</h6></span>
                    <span><h6 class="card-title">{{ my_team_summ }} USDT</h6></span>    
                </div>
            </a>
    </div>
    <div class="col-sm-12 mb-1">
            <div class="card text-secondary shadow p-3 mb-1 bg-light rounded">
                <div class="card-body d-flex justify-content-between">    
                    <span><h6 class="card-title">Моя сторона в сети</h6></span>
                    <span><h6 class="card-title">{{ referral_network.userStatus }}</h6></span>    
                </div>
            </в>
    </div>
    <div class="col-sm-12 mb-1">
            <div class="card text-secondary shadow p-3 mb-1 bg-light rounded">
                <div class="card-body d-flex justify-content-between">    
                    <span><h6 class="card-title">Мои начисления по программе Cashback</h6></span>
                    <span><h6 class="card-title">{{ referral_network.cash }} USDT</h6></span>    
                </div>
            </в>
    </div>
    <div class="col-sm-12 mb-1">
            <div class="card text-secondary shadow p-3 mb-1 bg-light rounded">
                <div class="card-body d-flex justify-content-between">    
                    <span><h6 class="card-title">Мои начисления по программе Direct</h6></span>
                    <span><h6 class="card-title">{{ referral_network.direct }} USDT</h6></span>    
                </div>
            </в>
    </div>
        
    {% if is_granted('ROLE_ADMIN') %}
    <div class="col-sm-12 mb-1">
            <div class="card text-secondary shadow p-3 mb-1 bg-white rounded">
                <div class="card-body">
                <table class="table">
                    <tbody>    
                        <h5 class="card-title mb-3">Для Администратора - информация о сети на момент активации пакета данного пользователя</h5>
                        <tr class="shadow p-3 mb-1 bg-light rounded">
                            <th>Выплата в компанию (проект) в момент активации пакета данного участника</th>
                            <td>{{ referral_network.currentNetworkProfit }} USDT</td>
                        </tr>
                        <tr class="shadow p-3 mb-1 bg-light rounded">
                            <th>Выплата в сеть по программе Direct в момент активации пакета данного пользователя</th>
                            <td>{{ referral_network.paymentsNetwork }} USDT</td>
                        </tr>
                        <tr class="shadow p-3 mb-1 bg-light rounded">
                            <th>Выплата в сеть по программе Cash back в момент активации пакета данного пользователя</th>
                            <td>{{ referral_network.cash }} USDT</td>
                        </tr>    
                    </tbody>
                </table>
                </div>
            </div>
    </div>
    
    <div class="col-sm-12 mb-1">
            <div class="card text-center shadow p-3 mb-1 bg-light rounded">
                <div class="card-body">
                    {% if is_granted('ROLE_ADMIN') %}  
                    <a  class="btn btn-secondary mb-1" href="{{ path('app_referral_network_index') }}">К списку всех участников</a>
                    {% else %}
                    <a  class="btn btn-secondary mb-1" href="{{ path('app_personal_area') }}">В личный кабинет</a>
                    {% endif %}
                    <a  class="btn btn-secondary mb-1" href="{{ path('app_referral_network_myteam',{'my_team': referral_network.myTeam}) }}">Посмотреть команду</a>
                    <a  class="btn btn-secondary mb-1" href="{{ path('app_personal_area') }}">Повысить пакет</a>
                    
                    <a class="btn btn-warning mb-1" href="{{ path('app_referral_network_edit', {'id': referral_network.id}) }}">Редактировать</a>

                    {{ include('referral_network/_delete_form.html.twig') }}
                </div>
            </div>
        </div>
    {% endif %}

<div id="hidden-content-referral">
    {{ form_start(referral_link_to_email_form) }}
    <div class="form_box-inner">
        <div class="form_box-left">
            
            {{ form_row(referral_link_to_email_form.email_to_client) }}

            {{ form_row(referral_link_to_email_form.referral_link) }}
            {{ form_row(referral_link_to_email_form.user_id) }}
            
            <input type="submit" value="Отправить">
        </div>
    </div>
    {{ form_end(referral_link_to_email_form) }}
</div>    
    

</div>
<script>
var chart = bb.generate({
        data: {
          columns: [
            ["Blue USDT", {{ referral_network.direct }}],
            ["Orange Cometpoin", {{ referral_network.cash }}],
            //["green", 3],
          ],
          type: "donut",
          onclick: function (d, i) {
            console.log("onclick", d, i);
          },
          onover: function (d, i) {
            console.log("onover", d, i);
          },
          onout: function (d, i) {
            console.log("onout", d, i);
          },
        },
        donut: {
          title: "Всего {{ referral_network.reward }}",
        },
        bindto: "#donut-chart-my-position",
      });
</script>
{% endblock %}
{# {% block javascripts %}
            {{ include('js_show_my_position.html.twig') }}
{% endblock %} #}
